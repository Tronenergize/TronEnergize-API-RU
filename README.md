# TronEnergize Публичное Rest API
## Обзор публичного Rest API TronEnergize:

Публичный Rest API TronEnergize предоставляет разработчикам мощный набор инструментов для программного взаимодействия с энергетической биржей TronEnergize. Это API позволяет пользователям получать доступ к основным рыночным данным, управлять энергетическими заказами и выполнять торговые операции.

## Основные особенности:

- Рыночные данные: Получайте минимальные цены и доступную энергию, чтобы принимать обоснованные решения.
- Управление заказами: Просматривайте список активных заказов, создавайте заказы и проверяйте статус существующих.
- Торговые операции: Создавайте неподписанные сырые транзакции для ПОКУПКИ заказов, создавайте и оплачивайте заказы с внутренних кошельков.

## Аутентификация:

Защищайте свои транзакции с помощью API Key и Secret для аутентификации.

## HTTP коды ответа:

Легко интерпретируйте ответы с помощью четких кодов ответа HTTP и сообщений об ошибках.

## Удобство использования:

JSON-ответы обеспечивают плавную интеграцию, позволяют разработчикам создавать настраиваемые интерфейсы и автоматизировать процессы покупки.

Исследуйте API TronEnergize, чтобы улучшить свой опыт на рынке энергии Tron!

## Общая информация об API
* Базовая точка входа: **https://tronenergize.com/**
* Точка входа для тестовой сети Nile: **https://nile.tronenergize.com/**
* Все конечные точки возвращают либо объект JSON, либо массив.
* Данные возвращаются в **возрастающем** порядке. Старые данные первыми, новые последними.
* Все поля, связанные со временем и отметками времени, указаны в **секундах**.

## Коды ответа HTTP

* Коды ответа HTTP `4XX` используются для некорректных запросов;
  проблема на стороне отправителя.
* Код ответа HTTP `403` используется, если нарушено ограничение WAF (веб-брандмауэра приложений).
* Код ответа HTTP `429` используется при превышении ограничения скорости запросов.
* Код ответа HTTP `418` используется, если IP-адрес был автоматически заблокирован за продолжение отправки запросов после получения кодов `429`.
* Коды ответа HTTP `5XX` используются для внутренних ошибок;
  Важно **НЕ** рассматривать это как сбой операции; статус выполнения
  **НЕИЗВЕСТЕН** и мог быть успешным.


## Коды ошибок.* Любая конечная точка может вернуть ошибку

Пример запроса ниже:
```javascript
{
  "code": 404,
  "msg": "Неверный аккаунт."
}
```

Code | Причина | Решение
--- | --- | ---
200 | Успешно | 
400 | Ошибка формата параметра тела запроса | Обычно возникает при POST-запросе, пожалуйста, проверьте правильность структуры JSON
403 | Ограничена частота запросов | Частота доступа в секунду ограничена до 5 qps. Пожалуйста, уменьшите частоту запросов или добавьте новый ключ
404 | Недостающие обязательные параметры | Пожалуйста, внимательно проверьте соответствие типов и значений параметров в документе и фактическом запросе
444 | Данные не существуют | 
500 | Операция не удалась. Пожалуйста, попробуйте еще раз позже | 
502 | Недостаточный баланс | 
505 | Неактивированный адрес | 

## Общая информация о конечных точках
* Для конечных точек типа `GET`, параметры должны быть отправлены в виде `query string`.


# Конечные точки общедоступного API

## Общие конечные точки
### Проверка возможности подключения
```
GET /api/v1/ping
```
Проверяет возможность подключения к REST API.

**Параметры:**
НЕТ

**Ответ:**
```javascript
{"time": 1695219834}
```
### Минимальные цены
```
GET /api/v1/minprices
```


**Параметры:**
НЕТ

**Ответ:**
```javascript
{
  "time": 1695219834,
  "data": {
      "1200":30,
      "7200":30
    },
}
```
### Доступная энергия
```
GET /api/v1/available
```

**Параметры:**
НЕТ

**Ответ:**
```javascript
{
  "time": 1695219834,
  "data": {
       "energy":50000000,
    }
}
```

## Конечные точки для рыночных данных
### Список заказов
```
GET /api/v1/market
```
Эта конечная точка позволяет получить список всех активных заказов

**Параметры:**
НЕТ

**Ответ:**
```javascript
{
  "time": 1596477571, 
  "data": [
      {
        "id": 787, 
        "payout": 777.5, 
        "stake": 77000, 
        "energy": 1000000, 
        "price": "45 SUN/день", 
        "apy": "77%", 
        "duration": "7 дней",
        "rawduration": 201600,
        "receiver": "TLwpQv9N6uXZQeE4jUudLPjcRffbXXAuru"
      }
      ...
    ]
}
```

## Конечные точки для торговли
### Создать необработанную RAW-транзакцию для Заказа на покупку.
```
GET /api/v1/neworder
```".**Параметры:**
Имя | Тип | Обязательный | Описание
------------ | ------------ | ------------ | ------------
buyer | STRING | ДА | Адрес покупки ресурса
energyamount | integer | ДА | Количество энергии в SUN
price | integer | ДА | Минимум 30
duration | STRING | ДА | Поддерживаются 1д, 3д, 7д, 14д, 1ч и 6ч

**Ответ:**
```javascript
{
  "time": 1596477571, 
  "data":{
           "tx": {"visible": false, "txID": "6debe75130870086575f90792f.. ..f8aa9b031"},
           "amount": 1.28
         }
}
```

### Создать заказ.
```
POST /api/v1/neworder
```

**Параметры:**
Имя | Тип | Обязательный | Описание
------------ | ------------ | ------------ | ------------
buyer | STRING | ДА | Адрес покупки ресурса
receiver | STRING | ДА | Адрес получения ресурса
energyamount | integer | ДА | Количество энергии в SUN
price | integer | ДА | Минимум 30
duration | STRING | ДА | Поддерживаются 1д, 3д, 7д, 14д, 1ч и 6ч
txid | STRING | ДА | Подписанный и переданный хеш транзакции

**Ответ:**
```javascript
{
  "time": 1596477571, 
  "data": {
        "id": 787, 
        "payout": 777.5, 
        "stake": 77000, 
        "energy": 1000000, 
        "price": "45 SUN/Day", 
        "apy": "77%", 
        "duration": "7 days",
        "rawduration": 201600,
        "receiver": "TLwpQv9N6uXZQeE4jUudLPjcRffbXXAuru"
      }
}
```

###  Статус заказа.
```
GET /api/v1/status/[orderId]
```
На этом конечном пункте возвращается статус ('active', 'filled', 'canceled') заказа.

**Параметры:**
Имя | Тип | Обязательный | Описание
------------ | ------------ | ------------ | ------------
orderid | STRING | ДА | Идентификатор заказа.

**Ответ:**
```javascript
{
  "time": 1596477571, 
  "data": [{
        "id": 787, 
        "payout": 777.5, 
        "stake": 77000, 
        "energy": 1000000, 
        "price": "45 SUN/Day", 
        "apy": "77%", 
        "duration": "7 days",
        "rawduration": 201600,
        "receiver": "TLwpQv9N6uXZQeE4jUudLPjcRffbXXAuru",
        "status": "active",
        "delegations": [".
```{
"txid": "7089e44e52e...513eba2bdfa78",
"energy": 1000000,
},
...
]

}```
# Аутентификация
Для аутентификации в API TronEnergize требуется действительный API Key.
Ваш API Key идентифицирует вашу учетную запись (подумайте о нем как о имени пользователя), а API Secret аутентифицирует вашу учетную запись (подумайте о нем как о пароле). Пожалуйста, следуйте инструкциям ниже, чтобы обезопасить ваш API Key и API Secret:

* Не отправляйте ваш API Secret вместе с запросами к API. Отправляйте только API Key.
* Не делитесь вашим API Secret или API Key с кем-либо.
* Не заливайте ваш API Secret в системы управления версиями, такие как github.
* Если вы потеряете ваш API Key или Secret, немедленно свяжитесь с Tronenergize support.

Учтите, что если ваш API Secret будет скомпрометирован, ваши средства будут под угрозой.

# Тип авторизации конечной точки
* У каждой следующей конечной точки есть тип авторизации, который определяет, как вы будете с ней работать. Это указано рядом с ИМЕНЕМ конечной точки.
* Если тип авторизации не указан, предполагайте, что тип авторизации - NONE.
* API-ключи передаются в Rest API через заголовок `X-TR-APIKEY`.
* API-ключи и секретные ключи **чувствительны к регистру**.

# Авторизация конечной точки SIGNED
* `SIGNED` конечные точки требуют дополнительный параметр `signature`, который передается в `query string` или `request body` или `HEADERS`.
* `signature` **не чувствителен к регистру**.

## Безопасность времени
* `SIGNED` конечная точка также требует параметра `timestamp`, который должен быть вторым временем создания и отправки запроса.

## Подписание запроса
Аутентифицированные вызовы требуют, чтобы вы отправляли подпись запроса с каждым запросом. Эта подпись должна быть сгенерирована заново для каждого запроса.

### Пример API Key/API Secret: 
Ключ | Значение
------------ | ------------
`apiKey` | API_my6mqen60xpwnewo2efckxtz
`secretKey` | S2808_61xkvn_bprxy5_s3szia

## Примеры конечных точек SIGNED для POST /api/v1/order".Вот пример пошагового процесса того, как отправить действительную подписанную нагрузку из командной строки Linux с помощью `echo`, `openssl` и `curl`.

Параметр | Значение
------------ | ------------
`receiver` | TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t
`energyamount` | 32000
`price` | 35
`duration` | 1d
`timestamp` | 1695219834

#### Пример 1: Как содержимое тела запроса
* **requestBody:** receiver=TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t&energyamount=32000&price=35&duration=1d&timestamp=1695219834
* **HMAC SHA256 подпись:**

    ```
    [linux]$ echo -n "receiver=TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t&energyamount=32000&price=35&duration=1d&timestamp=1695219834" | openssl dgst -sha256 -hmac "S2808_61xkvn_bprxy5_s3szia"
    (stdin)= 4e79a51a5bb2df5d3b894095d27d994c02f9f7705bc95eb4e4296b08b0af35fb
    ```


* **curl команда:**

    ```
    (HMAC SHA256)
    [linux]$ curl -H "X-TR-APIKEY: API_my6mqen60xpwnewo2efckxtz" -X POST 'https://nile.tronenergize.com/api/v1/order' -d 'receiver=TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t&energyamount=32000&price=35&duration=1d&timestamp=1695219834&signature=4e79a51a5bb2df5d3b894095d27d994c02f9f7705bc95eb4e4296b08b0af35fb'
    ```

#### Пример 2: Как строку запроса
* **queryString:** receiver=TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t&energyamount=32000&price=35&duration=1d&timestamp=1695219834
* **HMAC SHA256 подпись:**

    ```
    [linux]$ echo -n "receiver=TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t&energyamount=32000&price=35&duration=1d&timestamp=1695219834" | openssl dgst -sha256 -hmac "S2808_61xkvn_bprxy5_s3szia"
    (stdin)= 4e79a51a5bb2df5d3b894095d27d994c02f9f7705bc95eb4e4296b08b0af35fb
    ```

* **curl команда:**

    ```
    (HMAC SHA256)
    [linux]$ curl -H "X-TR-APIKEY: API_my6mqen60xpwnewo2efckxtz" -X GET 'https://nile.tronenergize.com/api/v1/order?receiver=TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t&energyamount=32000&price=35&duration=1d&timestamp=1695219834&signature=4e79a51a5bb2df5d3b894095d27d994c02f9f7705bc95eb4e4296b08b0af35fb'
    ```


### Создание заказа и оплата из внутреннего кошелька.
```
POST /api/v1/order
```

**HEADERS:**Name | Type | Mandatory | Description
------------ | ------------ | ------------ | ------------
X-TR-APIKEY | СТРОКА | ДА | Ваш ключ API


**Параметры:**
Name | Type | Mandatory | Description
------------ | ------------ | ------------ | ------------
receiver | СТРОКА | ДА | Адрес получателя ресурса
energyamount | целое число | ДА | Количество энергии в Санах
price | целое число | ДА | Минимум 30
duration | СТРОКА | ДА | Поддерживаются значения 1д, 3д, 7д, 14д, 1ч и 6ч
timestamp | целое число | ДА | Текущая временная метка в секундах
signature | СТРОКА | ДА | Подпись HMAC SHA256

**Ответ:**
```javascript
{
  "time": 1596477571, 
  "data":{
        "id": 787, 
        "payout": 777.5, 
        "stake": 77000, 
        "energy": 1000000, 
        "price": "45 Санов/день", 
        "duration": "7 дней",
        "txid": "8b317f47d79547a2...24cc6317d84d9",
        "receiver": "TLwpQv9N6uXZQeE4jUudLPjcRffbXXAuru"
      }
}
```